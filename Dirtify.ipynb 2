{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "32aef135-6145-4d6e-b318-0cb46670a70e",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-10-12T00:40:59.699234Z",
     "iopub.status.busy": "2022-10-12T00:40:59.699017Z",
     "iopub.status.idle": "2022-10-12T00:40:59.711267Z",
     "shell.execute_reply": "2022-10-12T00:40:59.710822Z",
     "shell.execute_reply.started": "2022-10-12T00:40:59.699202Z"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "import random\n",
    "import pandas as pd\n",
    "from sklearn.model_selection import train_test_split"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "3ba473a6-e14f-4fa9-bc04-c7eed987f12b",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-10-12T00:46:55.405437Z",
     "iopub.status.busy": "2022-10-12T00:46:55.405164Z",
     "iopub.status.idle": "2022-10-12T00:46:55.470828Z",
     "shell.execute_reply": "2022-10-12T00:46:55.470572Z",
     "shell.execute_reply.started": "2022-10-12T00:46:55.405421Z"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "df = pd.read_csv('./data/data_clean.csv')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "3d9f2281-3153-4066-9d8a-bc3c92140a8d",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-10-12T00:46:56.099991Z",
     "iopub.status.busy": "2022-10-12T00:46:56.099845Z",
     "iopub.status.idle": "2022-10-12T00:46:56.107304Z",
     "shell.execute_reply": "2022-10-12T00:46:56.107077Z",
     "shell.execute_reply.started": "2022-10-12T00:46:56.099976Z"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Bankrupt?</th>\n",
       "      <th>ROA(C) before interest and depreciation before interest</th>\n",
       "      <th>ROA(A) before interest and % after tax</th>\n",
       "      <th>ROA(B) before interest and depreciation after tax</th>\n",
       "      <th>Operating Gross Margin</th>\n",
       "      <th>Realized Sales Gross Margin</th>\n",
       "      <th>Operating Profit Rate</th>\n",
       "      <th>Pre-tax net Interest Rate</th>\n",
       "      <th>After-tax net Interest Rate</th>\n",
       "      <th>Non-industry income and expenditure/revenue</th>\n",
       "      <th>...</th>\n",
       "      <th>Net Income to Total Assets</th>\n",
       "      <th>Total assets to GNP price</th>\n",
       "      <th>No-credit Interval</th>\n",
       "      <th>Gross Profit to Sales</th>\n",
       "      <th>Net Income to Stockholder's Equity</th>\n",
       "      <th>Liability to Equity</th>\n",
       "      <th>Degree of Financial Leverage (DFL)</th>\n",
       "      <th>Interest Coverage Ratio (Interest expense to EBIT)</th>\n",
       "      <th>Net Income Flag</th>\n",
       "      <th>Equity to Liability</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1</td>\n",
       "      <td>0.370594</td>\n",
       "      <td>0.424389</td>\n",
       "      <td>0.405750</td>\n",
       "      <td>0.601457</td>\n",
       "      <td>0.601457</td>\n",
       "      <td>0.998969</td>\n",
       "      <td>0.796887</td>\n",
       "      <td>0.808809</td>\n",
       "      <td>0.302646</td>\n",
       "      <td>...</td>\n",
       "      <td>0.716845</td>\n",
       "      <td>0.009219</td>\n",
       "      <td>0.622879</td>\n",
       "      <td>0.601453</td>\n",
       "      <td>0.827890</td>\n",
       "      <td>0.290202</td>\n",
       "      <td>0.026601</td>\n",
       "      <td>0.564050</td>\n",
       "      <td>1</td>\n",
       "      <td>0.016469</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>1</td>\n",
       "      <td>0.464291</td>\n",
       "      <td>0.538214</td>\n",
       "      <td>0.516730</td>\n",
       "      <td>0.610235</td>\n",
       "      <td>0.610235</td>\n",
       "      <td>0.998946</td>\n",
       "      <td>0.797380</td>\n",
       "      <td>0.809301</td>\n",
       "      <td>0.303556</td>\n",
       "      <td>...</td>\n",
       "      <td>0.795297</td>\n",
       "      <td>0.008323</td>\n",
       "      <td>0.623652</td>\n",
       "      <td>0.610237</td>\n",
       "      <td>0.839969</td>\n",
       "      <td>0.283846</td>\n",
       "      <td>0.264577</td>\n",
       "      <td>0.570175</td>\n",
       "      <td>1</td>\n",
       "      <td>0.020794</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>1</td>\n",
       "      <td>0.426071</td>\n",
       "      <td>0.499019</td>\n",
       "      <td>0.472295</td>\n",
       "      <td>0.601450</td>\n",
       "      <td>0.601364</td>\n",
       "      <td>0.998857</td>\n",
       "      <td>0.796403</td>\n",
       "      <td>0.808388</td>\n",
       "      <td>0.302035</td>\n",
       "      <td>...</td>\n",
       "      <td>0.774670</td>\n",
       "      <td>0.040003</td>\n",
       "      <td>0.623841</td>\n",
       "      <td>0.601449</td>\n",
       "      <td>0.836774</td>\n",
       "      <td>0.290189</td>\n",
       "      <td>0.026555</td>\n",
       "      <td>0.563706</td>\n",
       "      <td>1</td>\n",
       "      <td>0.016474</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>1</td>\n",
       "      <td>0.399844</td>\n",
       "      <td>0.451265</td>\n",
       "      <td>0.457733</td>\n",
       "      <td>0.583541</td>\n",
       "      <td>0.583541</td>\n",
       "      <td>0.998700</td>\n",
       "      <td>0.796967</td>\n",
       "      <td>0.808966</td>\n",
       "      <td>0.303350</td>\n",
       "      <td>...</td>\n",
       "      <td>0.739555</td>\n",
       "      <td>0.003252</td>\n",
       "      <td>0.622929</td>\n",
       "      <td>0.583538</td>\n",
       "      <td>0.834697</td>\n",
       "      <td>0.281721</td>\n",
       "      <td>0.026697</td>\n",
       "      <td>0.564663</td>\n",
       "      <td>1</td>\n",
       "      <td>0.023982</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>1</td>\n",
       "      <td>0.465022</td>\n",
       "      <td>0.538432</td>\n",
       "      <td>0.522298</td>\n",
       "      <td>0.598783</td>\n",
       "      <td>0.598783</td>\n",
       "      <td>0.998973</td>\n",
       "      <td>0.797366</td>\n",
       "      <td>0.809304</td>\n",
       "      <td>0.303475</td>\n",
       "      <td>...</td>\n",
       "      <td>0.795016</td>\n",
       "      <td>0.003878</td>\n",
       "      <td>0.623521</td>\n",
       "      <td>0.598782</td>\n",
       "      <td>0.839973</td>\n",
       "      <td>0.278514</td>\n",
       "      <td>0.024752</td>\n",
       "      <td>0.575617</td>\n",
       "      <td>1</td>\n",
       "      <td>0.035490</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>5 rows × 96 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "   Bankrupt?   ROA(C) before interest and depreciation before interest  \\\n",
       "0          1                                           0.370594          \n",
       "1          1                                           0.464291          \n",
       "2          1                                           0.426071          \n",
       "3          1                                           0.399844          \n",
       "4          1                                           0.465022          \n",
       "\n",
       "    ROA(A) before interest and % after tax  \\\n",
       "0                                 0.424389   \n",
       "1                                 0.538214   \n",
       "2                                 0.499019   \n",
       "3                                 0.451265   \n",
       "4                                 0.538432   \n",
       "\n",
       "    ROA(B) before interest and depreciation after tax  \\\n",
       "0                                           0.405750    \n",
       "1                                           0.516730    \n",
       "2                                           0.472295    \n",
       "3                                           0.457733    \n",
       "4                                           0.522298    \n",
       "\n",
       "    Operating Gross Margin   Realized Sales Gross Margin  \\\n",
       "0                 0.601457                      0.601457   \n",
       "1                 0.610235                      0.610235   \n",
       "2                 0.601450                      0.601364   \n",
       "3                 0.583541                      0.583541   \n",
       "4                 0.598783                      0.598783   \n",
       "\n",
       "    Operating Profit Rate   Pre-tax net Interest Rate  \\\n",
       "0                0.998969                    0.796887   \n",
       "1                0.998946                    0.797380   \n",
       "2                0.998857                    0.796403   \n",
       "3                0.998700                    0.796967   \n",
       "4                0.998973                    0.797366   \n",
       "\n",
       "    After-tax net Interest Rate   Non-industry income and expenditure/revenue  \\\n",
       "0                      0.808809                                      0.302646   \n",
       "1                      0.809301                                      0.303556   \n",
       "2                      0.808388                                      0.302035   \n",
       "3                      0.808966                                      0.303350   \n",
       "4                      0.809304                                      0.303475   \n",
       "\n",
       "   ...   Net Income to Total Assets   Total assets to GNP price  \\\n",
       "0  ...                     0.716845                    0.009219   \n",
       "1  ...                     0.795297                    0.008323   \n",
       "2  ...                     0.774670                    0.040003   \n",
       "3  ...                     0.739555                    0.003252   \n",
       "4  ...                     0.795016                    0.003878   \n",
       "\n",
       "    No-credit Interval   Gross Profit to Sales  \\\n",
       "0             0.622879                0.601453   \n",
       "1             0.623652                0.610237   \n",
       "2             0.623841                0.601449   \n",
       "3             0.622929                0.583538   \n",
       "4             0.623521                0.598782   \n",
       "\n",
       "    Net Income to Stockholder's Equity   Liability to Equity  \\\n",
       "0                             0.827890              0.290202   \n",
       "1                             0.839969              0.283846   \n",
       "2                             0.836774              0.290189   \n",
       "3                             0.834697              0.281721   \n",
       "4                             0.839973              0.278514   \n",
       "\n",
       "    Degree of Financial Leverage (DFL)  \\\n",
       "0                             0.026601   \n",
       "1                             0.264577   \n",
       "2                             0.026555   \n",
       "3                             0.026697   \n",
       "4                             0.024752   \n",
       "\n",
       "    Interest Coverage Ratio (Interest expense to EBIT)   Net Income Flag  \\\n",
       "0                                           0.564050                   1   \n",
       "1                                           0.570175                   1   \n",
       "2                                           0.563706                   1   \n",
       "3                                           0.564663                   1   \n",
       "4                                           0.575617                   1   \n",
       "\n",
       "    Equity to Liability  \n",
       "0              0.016469  \n",
       "1              0.020794  \n",
       "2              0.016474  \n",
       "3              0.023982  \n",
       "4              0.035490  \n",
       "\n",
       "[5 rows x 96 columns]"
      ]
     },
     "execution_count": 3,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "id": "80a9cab9-a789-4c6d-83fc-c0c7a5157d3b",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-10-12T00:46:56.819423Z",
     "iopub.status.busy": "2022-10-12T00:46:56.819272Z",
     "iopub.status.idle": "2022-10-12T00:46:56.822804Z",
     "shell.execute_reply": "2022-10-12T00:46:56.822518Z",
     "shell.execute_reply.started": "2022-10-12T00:46:56.819411Z"
    },
    "scrolled": true,
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0    6599\n",
       "1     220\n",
       "Name: Bankrupt?, dtype: int64"
      ]
     },
     "execution_count": 15,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df['Bankrupt?'].value_counts()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "6fb69e1d",
   "metadata": {},
   "outputs": [],
   "source": [
    "y = df['Bankrupt?']\n",
    "X = df.drop('Bankrupt?', axis = 1)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "692b70e0",
   "metadata": {},
   "outputs": [],
   "source": [
    "X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, stratify=y, random_state=123)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "ffa167ba",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0    5279\n",
       "1     176\n",
       "Name: Bankrupt?, dtype: int64"
      ]
     },
     "execution_count": 8,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "y_train.value_counts()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "aa6ac12e",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0    1320\n",
       "1      44\n",
       "Name: Bankrupt?, dtype: int64"
      ]
     },
     "execution_count": 9,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "y_test.value_counts()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "id": "985143d3",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Bankrupt?</th>\n",
       "      <th>ROA(C) before interest and depreciation before interest</th>\n",
       "      <th>ROA(A) before interest and % after tax</th>\n",
       "      <th>ROA(B) before interest and depreciation after tax</th>\n",
       "      <th>Operating Gross Margin</th>\n",
       "      <th>Realized Sales Gross Margin</th>\n",
       "      <th>Operating Profit Rate</th>\n",
       "      <th>Pre-tax net Interest Rate</th>\n",
       "      <th>After-tax net Interest Rate</th>\n",
       "      <th>Non-industry income and expenditure/revenue</th>\n",
       "      <th>...</th>\n",
       "      <th>Net Income to Total Assets</th>\n",
       "      <th>Total assets to GNP price</th>\n",
       "      <th>No-credit Interval</th>\n",
       "      <th>Gross Profit to Sales</th>\n",
       "      <th>Net Income to Stockholder's Equity</th>\n",
       "      <th>Liability to Equity</th>\n",
       "      <th>Degree of Financial Leverage (DFL)</th>\n",
       "      <th>Interest Coverage Ratio (Interest expense to EBIT)</th>\n",
       "      <th>Net Income Flag</th>\n",
       "      <th>Equity to Liability</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>0</td>\n",
       "      <td>0.522157</td>\n",
       "      <td>0.573048</td>\n",
       "      <td>0.567964</td>\n",
       "      <td>0.603511</td>\n",
       "      <td>0.603461</td>\n",
       "      <td>0.999047</td>\n",
       "      <td>0.797463</td>\n",
       "      <td>0.809365</td>\n",
       "      <td>0.303491</td>\n",
       "      <td>...</td>\n",
       "      <td>0.813520</td>\n",
       "      <td>0.004772</td>\n",
       "      <td>0.624501</td>\n",
       "      <td>0.603512</td>\n",
       "      <td>0.842215</td>\n",
       "      <td>0.285898</td>\n",
       "      <td>0.026947</td>\n",
       "      <td>0.565805</td>\n",
       "      <td>1</td>\n",
       "      <td>0.018862</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>1</td>\n",
       "      <td>0.479745</td>\n",
       "      <td>0.545028</td>\n",
       "      <td>0.530060</td>\n",
       "      <td>0.619020</td>\n",
       "      <td>0.618235</td>\n",
       "      <td>0.999088</td>\n",
       "      <td>0.797430</td>\n",
       "      <td>0.809334</td>\n",
       "      <td>0.303347</td>\n",
       "      <td>...</td>\n",
       "      <td>0.798701</td>\n",
       "      <td>0.003045</td>\n",
       "      <td>0.623882</td>\n",
       "      <td>0.619021</td>\n",
       "      <td>0.840290</td>\n",
       "      <td>0.281135</td>\n",
       "      <td>0.028226</td>\n",
       "      <td>0.568060</td>\n",
       "      <td>1</td>\n",
       "      <td>0.025232</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>0</td>\n",
       "      <td>0.512017</td>\n",
       "      <td>0.572667</td>\n",
       "      <td>0.554901</td>\n",
       "      <td>0.599540</td>\n",
       "      <td>0.599562</td>\n",
       "      <td>0.999022</td>\n",
       "      <td>0.797476</td>\n",
       "      <td>0.809373</td>\n",
       "      <td>0.303565</td>\n",
       "      <td>...</td>\n",
       "      <td>0.818102</td>\n",
       "      <td>0.001597</td>\n",
       "      <td>0.624402</td>\n",
       "      <td>0.599540</td>\n",
       "      <td>0.841820</td>\n",
       "      <td>0.279641</td>\n",
       "      <td>0.026856</td>\n",
       "      <td>0.565451</td>\n",
       "      <td>1</td>\n",
       "      <td>0.029750</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>0</td>\n",
       "      <td>0.552235</td>\n",
       "      <td>0.588421</td>\n",
       "      <td>0.600460</td>\n",
       "      <td>0.601637</td>\n",
       "      <td>0.601637</td>\n",
       "      <td>0.999005</td>\n",
       "      <td>0.797456</td>\n",
       "      <td>0.809365</td>\n",
       "      <td>0.303566</td>\n",
       "      <td>...</td>\n",
       "      <td>0.826423</td>\n",
       "      <td>0.002992</td>\n",
       "      <td>0.623782</td>\n",
       "      <td>0.601634</td>\n",
       "      <td>0.842689</td>\n",
       "      <td>0.280590</td>\n",
       "      <td>0.026810</td>\n",
       "      <td>0.565248</td>\n",
       "      <td>1</td>\n",
       "      <td>0.026615</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>0</td>\n",
       "      <td>0.483450</td>\n",
       "      <td>0.520443</td>\n",
       "      <td>0.535093</td>\n",
       "      <td>0.602012</td>\n",
       "      <td>0.602236</td>\n",
       "      <td>0.998986</td>\n",
       "      <td>0.797288</td>\n",
       "      <td>0.809199</td>\n",
       "      <td>0.303311</td>\n",
       "      <td>...</td>\n",
       "      <td>0.787805</td>\n",
       "      <td>0.071523</td>\n",
       "      <td>0.623732</td>\n",
       "      <td>0.602011</td>\n",
       "      <td>0.839478</td>\n",
       "      <td>0.278023</td>\n",
       "      <td>0.026363</td>\n",
       "      <td>0.561720</td>\n",
       "      <td>1</td>\n",
       "      <td>0.039200</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1359</th>\n",
       "      <td>0</td>\n",
       "      <td>0.641496</td>\n",
       "      <td>0.673953</td>\n",
       "      <td>0.692703</td>\n",
       "      <td>0.624123</td>\n",
       "      <td>0.624123</td>\n",
       "      <td>0.999118</td>\n",
       "      <td>0.797564</td>\n",
       "      <td>0.809473</td>\n",
       "      <td>0.303518</td>\n",
       "      <td>...</td>\n",
       "      <td>0.863393</td>\n",
       "      <td>0.000394</td>\n",
       "      <td>0.623841</td>\n",
       "      <td>0.624121</td>\n",
       "      <td>0.844320</td>\n",
       "      <td>0.277211</td>\n",
       "      <td>0.026793</td>\n",
       "      <td>0.565167</td>\n",
       "      <td>1</td>\n",
       "      <td>0.048504</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1360</th>\n",
       "      <td>0</td>\n",
       "      <td>0.502072</td>\n",
       "      <td>0.559256</td>\n",
       "      <td>0.545318</td>\n",
       "      <td>0.595951</td>\n",
       "      <td>0.595958</td>\n",
       "      <td>0.998985</td>\n",
       "      <td>0.797393</td>\n",
       "      <td>0.809314</td>\n",
       "      <td>0.303498</td>\n",
       "      <td>...</td>\n",
       "      <td>0.803781</td>\n",
       "      <td>0.002439</td>\n",
       "      <td>0.624020</td>\n",
       "      <td>0.595951</td>\n",
       "      <td>0.840781</td>\n",
       "      <td>0.281693</td>\n",
       "      <td>0.027942</td>\n",
       "      <td>0.567785</td>\n",
       "      <td>1</td>\n",
       "      <td>0.024037</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1361</th>\n",
       "      <td>1</td>\n",
       "      <td>0.443670</td>\n",
       "      <td>0.520061</td>\n",
       "      <td>0.497564</td>\n",
       "      <td>0.599201</td>\n",
       "      <td>0.599129</td>\n",
       "      <td>0.998948</td>\n",
       "      <td>0.797277</td>\n",
       "      <td>0.809229</td>\n",
       "      <td>0.303373</td>\n",
       "      <td>...</td>\n",
       "      <td>0.787149</td>\n",
       "      <td>0.001668</td>\n",
       "      <td>0.624062</td>\n",
       "      <td>0.599201</td>\n",
       "      <td>0.839373</td>\n",
       "      <td>0.278995</td>\n",
       "      <td>0.026457</td>\n",
       "      <td>0.562826</td>\n",
       "      <td>1</td>\n",
       "      <td>0.032673</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1362</th>\n",
       "      <td>0</td>\n",
       "      <td>0.508507</td>\n",
       "      <td>0.560946</td>\n",
       "      <td>0.559934</td>\n",
       "      <td>0.611633</td>\n",
       "      <td>0.611633</td>\n",
       "      <td>0.999036</td>\n",
       "      <td>0.797489</td>\n",
       "      <td>0.809392</td>\n",
       "      <td>0.303557</td>\n",
       "      <td>...</td>\n",
       "      <td>0.811532</td>\n",
       "      <td>0.000872</td>\n",
       "      <td>0.623672</td>\n",
       "      <td>0.611628</td>\n",
       "      <td>0.841432</td>\n",
       "      <td>0.280931</td>\n",
       "      <td>0.026898</td>\n",
       "      <td>0.565620</td>\n",
       "      <td>1</td>\n",
       "      <td>0.025722</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1363</th>\n",
       "      <td>0</td>\n",
       "      <td>0.435187</td>\n",
       "      <td>0.503598</td>\n",
       "      <td>0.502543</td>\n",
       "      <td>0.614869</td>\n",
       "      <td>0.615150</td>\n",
       "      <td>0.998929</td>\n",
       "      <td>0.797187</td>\n",
       "      <td>0.809198</td>\n",
       "      <td>0.303255</td>\n",
       "      <td>...</td>\n",
       "      <td>0.778489</td>\n",
       "      <td>0.000431</td>\n",
       "      <td>0.623888</td>\n",
       "      <td>0.614866</td>\n",
       "      <td>0.838912</td>\n",
       "      <td>0.277383</td>\n",
       "      <td>0.026787</td>\n",
       "      <td>0.565138</td>\n",
       "      <td>1</td>\n",
       "      <td>0.046061</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>1364 rows × 96 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "      Bankrupt?   ROA(C) before interest and depreciation before interest  \\\n",
       "0             0                                           0.522157          \n",
       "1             1                                           0.479745          \n",
       "2             0                                           0.512017          \n",
       "3             0                                           0.552235          \n",
       "4             0                                           0.483450          \n",
       "...         ...                                                ...          \n",
       "1359          0                                           0.641496          \n",
       "1360          0                                           0.502072          \n",
       "1361          1                                           0.443670          \n",
       "1362          0                                           0.508507          \n",
       "1363          0                                           0.435187          \n",
       "\n",
       "       ROA(A) before interest and % after tax  \\\n",
       "0                                    0.573048   \n",
       "1                                    0.545028   \n",
       "2                                    0.572667   \n",
       "3                                    0.588421   \n",
       "4                                    0.520443   \n",
       "...                                       ...   \n",
       "1359                                 0.673953   \n",
       "1360                                 0.559256   \n",
       "1361                                 0.520061   \n",
       "1362                                 0.560946   \n",
       "1363                                 0.503598   \n",
       "\n",
       "       ROA(B) before interest and depreciation after tax  \\\n",
       "0                                              0.567964    \n",
       "1                                              0.530060    \n",
       "2                                              0.554901    \n",
       "3                                              0.600460    \n",
       "4                                              0.535093    \n",
       "...                                                 ...    \n",
       "1359                                           0.692703    \n",
       "1360                                           0.545318    \n",
       "1361                                           0.497564    \n",
       "1362                                           0.559934    \n",
       "1363                                           0.502543    \n",
       "\n",
       "       Operating Gross Margin   Realized Sales Gross Margin  \\\n",
       "0                    0.603511                      0.603461   \n",
       "1                    0.619020                      0.618235   \n",
       "2                    0.599540                      0.599562   \n",
       "3                    0.601637                      0.601637   \n",
       "4                    0.602012                      0.602236   \n",
       "...                       ...                           ...   \n",
       "1359                 0.624123                      0.624123   \n",
       "1360                 0.595951                      0.595958   \n",
       "1361                 0.599201                      0.599129   \n",
       "1362                 0.611633                      0.611633   \n",
       "1363                 0.614869                      0.615150   \n",
       "\n",
       "       Operating Profit Rate   Pre-tax net Interest Rate  \\\n",
       "0                   0.999047                    0.797463   \n",
       "1                   0.999088                    0.797430   \n",
       "2                   0.999022                    0.797476   \n",
       "3                   0.999005                    0.797456   \n",
       "4                   0.998986                    0.797288   \n",
       "...                      ...                         ...   \n",
       "1359                0.999118                    0.797564   \n",
       "1360                0.998985                    0.797393   \n",
       "1361                0.998948                    0.797277   \n",
       "1362                0.999036                    0.797489   \n",
       "1363                0.998929                    0.797187   \n",
       "\n",
       "       After-tax net Interest Rate  \\\n",
       "0                         0.809365   \n",
       "1                         0.809334   \n",
       "2                         0.809373   \n",
       "3                         0.809365   \n",
       "4                         0.809199   \n",
       "...                            ...   \n",
       "1359                      0.809473   \n",
       "1360                      0.809314   \n",
       "1361                      0.809229   \n",
       "1362                      0.809392   \n",
       "1363                      0.809198   \n",
       "\n",
       "       Non-industry income and expenditure/revenue  ...  \\\n",
       "0                                         0.303491  ...   \n",
       "1                                         0.303347  ...   \n",
       "2                                         0.303565  ...   \n",
       "3                                         0.303566  ...   \n",
       "4                                         0.303311  ...   \n",
       "...                                            ...  ...   \n",
       "1359                                      0.303518  ...   \n",
       "1360                                      0.303498  ...   \n",
       "1361                                      0.303373  ...   \n",
       "1362                                      0.303557  ...   \n",
       "1363                                      0.303255  ...   \n",
       "\n",
       "       Net Income to Total Assets   Total assets to GNP price  \\\n",
       "0                        0.813520                    0.004772   \n",
       "1                        0.798701                    0.003045   \n",
       "2                        0.818102                    0.001597   \n",
       "3                        0.826423                    0.002992   \n",
       "4                        0.787805                    0.071523   \n",
       "...                           ...                         ...   \n",
       "1359                     0.863393                    0.000394   \n",
       "1360                     0.803781                    0.002439   \n",
       "1361                     0.787149                    0.001668   \n",
       "1362                     0.811532                    0.000872   \n",
       "1363                     0.778489                    0.000431   \n",
       "\n",
       "       No-credit Interval   Gross Profit to Sales  \\\n",
       "0                0.624501                0.603512   \n",
       "1                0.623882                0.619021   \n",
       "2                0.624402                0.599540   \n",
       "3                0.623782                0.601634   \n",
       "4                0.623732                0.602011   \n",
       "...                   ...                     ...   \n",
       "1359             0.623841                0.624121   \n",
       "1360             0.624020                0.595951   \n",
       "1361             0.624062                0.599201   \n",
       "1362             0.623672                0.611628   \n",
       "1363             0.623888                0.614866   \n",
       "\n",
       "       Net Income to Stockholder's Equity   Liability to Equity  \\\n",
       "0                                0.842215              0.285898   \n",
       "1                                0.840290              0.281135   \n",
       "2                                0.841820              0.279641   \n",
       "3                                0.842689              0.280590   \n",
       "4                                0.839478              0.278023   \n",
       "...                                   ...                   ...   \n",
       "1359                             0.844320              0.277211   \n",
       "1360                             0.840781              0.281693   \n",
       "1361                             0.839373              0.278995   \n",
       "1362                             0.841432              0.280931   \n",
       "1363                             0.838912              0.277383   \n",
       "\n",
       "       Degree of Financial Leverage (DFL)  \\\n",
       "0                                0.026947   \n",
       "1                                0.028226   \n",
       "2                                0.026856   \n",
       "3                                0.026810   \n",
       "4                                0.026363   \n",
       "...                                   ...   \n",
       "1359                             0.026793   \n",
       "1360                             0.027942   \n",
       "1361                             0.026457   \n",
       "1362                             0.026898   \n",
       "1363                             0.026787   \n",
       "\n",
       "       Interest Coverage Ratio (Interest expense to EBIT)   Net Income Flag  \\\n",
       "0                                              0.565805                   1   \n",
       "1                                              0.568060                   1   \n",
       "2                                              0.565451                   1   \n",
       "3                                              0.565248                   1   \n",
       "4                                              0.561720                   1   \n",
       "...                                                 ...                 ...   \n",
       "1359                                           0.565167                   1   \n",
       "1360                                           0.567785                   1   \n",
       "1361                                           0.562826                   1   \n",
       "1362                                           0.565620                   1   \n",
       "1363                                           0.565138                   1   \n",
       "\n",
       "       Equity to Liability  \n",
       "0                 0.018862  \n",
       "1                 0.025232  \n",
       "2                 0.029750  \n",
       "3                 0.026615  \n",
       "4                 0.039200  \n",
       "...                    ...  \n",
       "1359              0.048504  \n",
       "1360              0.024037  \n",
       "1361              0.032673  \n",
       "1362              0.025722  \n",
       "1363              0.046061  \n",
       "\n",
       "[1364 rows x 96 columns]"
      ]
     },
     "execution_count": 12,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "test_clean = pd.concat([y_test, X_test], axis = 1).reset_index(drop=True)\n",
    "test_clean"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "id": "b1eec646",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Bankrupt?</th>\n",
       "      <th>ROA(C) before interest and depreciation before interest</th>\n",
       "      <th>ROA(A) before interest and % after tax</th>\n",
       "      <th>ROA(B) before interest and depreciation after tax</th>\n",
       "      <th>Operating Gross Margin</th>\n",
       "      <th>Realized Sales Gross Margin</th>\n",
       "      <th>Operating Profit Rate</th>\n",
       "      <th>Pre-tax net Interest Rate</th>\n",
       "      <th>After-tax net Interest Rate</th>\n",
       "      <th>Non-industry income and expenditure/revenue</th>\n",
       "      <th>...</th>\n",
       "      <th>Net Income to Total Assets</th>\n",
       "      <th>Total assets to GNP price</th>\n",
       "      <th>No-credit Interval</th>\n",
       "      <th>Gross Profit to Sales</th>\n",
       "      <th>Net Income to Stockholder's Equity</th>\n",
       "      <th>Liability to Equity</th>\n",
       "      <th>Degree of Financial Leverage (DFL)</th>\n",
       "      <th>Interest Coverage Ratio (Interest expense to EBIT)</th>\n",
       "      <th>Net Income Flag</th>\n",
       "      <th>Equity to Liability</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>0</td>\n",
       "      <td>0.498854</td>\n",
       "      <td>0.560565</td>\n",
       "      <td>0.549708</td>\n",
       "      <td>0.607316</td>\n",
       "      <td>0.607316</td>\n",
       "      <td>0.999055</td>\n",
       "      <td>0.797450</td>\n",
       "      <td>0.809359</td>\n",
       "      <td>0.303450</td>\n",
       "      <td>...</td>\n",
       "      <td>0.807623</td>\n",
       "      <td>0.001475</td>\n",
       "      <td>0.623535</td>\n",
       "      <td>0.607317</td>\n",
       "      <td>0.841014</td>\n",
       "      <td>0.280081</td>\n",
       "      <td>0.027375</td>\n",
       "      <td>0.566952</td>\n",
       "      <td>1</td>\n",
       "      <td>0.028160</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>0</td>\n",
       "      <td>0.679764</td>\n",
       "      <td>0.719472</td>\n",
       "      <td>0.704053</td>\n",
       "      <td>0.616073</td>\n",
       "      <td>0.615972</td>\n",
       "      <td>0.999202</td>\n",
       "      <td>0.797674</td>\n",
       "      <td>0.809526</td>\n",
       "      <td>0.303534</td>\n",
       "      <td>...</td>\n",
       "      <td>0.899004</td>\n",
       "      <td>0.000855</td>\n",
       "      <td>0.623871</td>\n",
       "      <td>0.616068</td>\n",
       "      <td>0.846265</td>\n",
       "      <td>0.276771</td>\n",
       "      <td>0.026791</td>\n",
       "      <td>0.565158</td>\n",
       "      <td>1</td>\n",
       "      <td>0.056558</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>0</td>\n",
       "      <td>0.543558</td>\n",
       "      <td>0.608973</td>\n",
       "      <td>0.597569</td>\n",
       "      <td>0.611554</td>\n",
       "      <td>0.611720</td>\n",
       "      <td>0.999118</td>\n",
       "      <td>0.797594</td>\n",
       "      <td>0.809503</td>\n",
       "      <td>0.303569</td>\n",
       "      <td>...</td>\n",
       "      <td>0.841140</td>\n",
       "      <td>0.004898</td>\n",
       "      <td>0.624184</td>\n",
       "      <td>0.611554</td>\n",
       "      <td>0.842434</td>\n",
       "      <td>0.275700</td>\n",
       "      <td>0.026791</td>\n",
       "      <td>0.565159</td>\n",
       "      <td>1</td>\n",
       "      <td>0.105285</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>0</td>\n",
       "      <td>0.505192</td>\n",
       "      <td>0.570214</td>\n",
       "      <td>0.556025</td>\n",
       "      <td>0.604729</td>\n",
       "      <td>0.604729</td>\n",
       "      <td>0.999047</td>\n",
       "      <td>0.797472</td>\n",
       "      <td>0.809390</td>\n",
       "      <td>0.303504</td>\n",
       "      <td>...</td>\n",
       "      <td>0.817066</td>\n",
       "      <td>0.002805</td>\n",
       "      <td>0.624377</td>\n",
       "      <td>0.604729</td>\n",
       "      <td>0.841313</td>\n",
       "      <td>0.276750</td>\n",
       "      <td>0.026837</td>\n",
       "      <td>0.565368</td>\n",
       "      <td>1</td>\n",
       "      <td>0.057029</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>0</td>\n",
       "      <td>0.539414</td>\n",
       "      <td>0.578500</td>\n",
       "      <td>0.597409</td>\n",
       "      <td>0.615438</td>\n",
       "      <td>0.615438</td>\n",
       "      <td>0.999231</td>\n",
       "      <td>0.797687</td>\n",
       "      <td>0.809584</td>\n",
       "      <td>0.303496</td>\n",
       "      <td>...</td>\n",
       "      <td>0.821655</td>\n",
       "      <td>0.009206</td>\n",
       "      <td>0.623211</td>\n",
       "      <td>0.615437</td>\n",
       "      <td>0.841686</td>\n",
       "      <td>0.277291</td>\n",
       "      <td>0.026900</td>\n",
       "      <td>0.565631</td>\n",
       "      <td>1</td>\n",
       "      <td>0.047331</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5450</th>\n",
       "      <td>0</td>\n",
       "      <td>0.555940</td>\n",
       "      <td>0.618785</td>\n",
       "      <td>0.603673</td>\n",
       "      <td>0.630306</td>\n",
       "      <td>0.630306</td>\n",
       "      <td>0.999299</td>\n",
       "      <td>0.797846</td>\n",
       "      <td>0.809682</td>\n",
       "      <td>0.303632</td>\n",
       "      <td>...</td>\n",
       "      <td>0.832318</td>\n",
       "      <td>0.000265</td>\n",
       "      <td>0.624879</td>\n",
       "      <td>0.630304</td>\n",
       "      <td>0.842058</td>\n",
       "      <td>0.276061</td>\n",
       "      <td>0.026863</td>\n",
       "      <td>0.565480</td>\n",
       "      <td>1</td>\n",
       "      <td>0.080379</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5451</th>\n",
       "      <td>0</td>\n",
       "      <td>0.456637</td>\n",
       "      <td>0.519298</td>\n",
       "      <td>0.509717</td>\n",
       "      <td>0.595764</td>\n",
       "      <td>0.595749</td>\n",
       "      <td>0.998958</td>\n",
       "      <td>0.797324</td>\n",
       "      <td>0.809262</td>\n",
       "      <td>0.303433</td>\n",
       "      <td>...</td>\n",
       "      <td>0.788500</td>\n",
       "      <td>0.005053</td>\n",
       "      <td>0.623824</td>\n",
       "      <td>0.595764</td>\n",
       "      <td>0.839630</td>\n",
       "      <td>0.276012</td>\n",
       "      <td>0.026779</td>\n",
       "      <td>0.565101</td>\n",
       "      <td>1</td>\n",
       "      <td>0.082966</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5452</th>\n",
       "      <td>1</td>\n",
       "      <td>0.448789</td>\n",
       "      <td>0.508068</td>\n",
       "      <td>0.499706</td>\n",
       "      <td>0.602099</td>\n",
       "      <td>0.602099</td>\n",
       "      <td>0.998942</td>\n",
       "      <td>0.797297</td>\n",
       "      <td>0.809229</td>\n",
       "      <td>0.303420</td>\n",
       "      <td>...</td>\n",
       "      <td>0.778877</td>\n",
       "      <td>0.000772</td>\n",
       "      <td>0.623349</td>\n",
       "      <td>0.602094</td>\n",
       "      <td>0.836233</td>\n",
       "      <td>0.300209</td>\n",
       "      <td>0.026522</td>\n",
       "      <td>0.563438</td>\n",
       "      <td>1</td>\n",
       "      <td>0.014024</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5453</th>\n",
       "      <td>0</td>\n",
       "      <td>0.550041</td>\n",
       "      <td>0.595999</td>\n",
       "      <td>0.593287</td>\n",
       "      <td>0.618242</td>\n",
       "      <td>0.619294</td>\n",
       "      <td>0.999210</td>\n",
       "      <td>0.797626</td>\n",
       "      <td>0.809502</td>\n",
       "      <td>0.303434</td>\n",
       "      <td>...</td>\n",
       "      <td>0.828522</td>\n",
       "      <td>0.000983</td>\n",
       "      <td>0.623696</td>\n",
       "      <td>0.618238</td>\n",
       "      <td>0.843258</td>\n",
       "      <td>0.282299</td>\n",
       "      <td>0.026844</td>\n",
       "      <td>0.565399</td>\n",
       "      <td>1</td>\n",
       "      <td>0.022939</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5454</th>\n",
       "      <td>0</td>\n",
       "      <td>0.526398</td>\n",
       "      <td>0.586895</td>\n",
       "      <td>0.566519</td>\n",
       "      <td>0.606740</td>\n",
       "      <td>0.606740</td>\n",
       "      <td>0.999103</td>\n",
       "      <td>0.797606</td>\n",
       "      <td>0.809470</td>\n",
       "      <td>0.303622</td>\n",
       "      <td>...</td>\n",
       "      <td>0.828627</td>\n",
       "      <td>0.002505</td>\n",
       "      <td>0.624714</td>\n",
       "      <td>0.606739</td>\n",
       "      <td>0.841982</td>\n",
       "      <td>0.276632</td>\n",
       "      <td>0.026791</td>\n",
       "      <td>0.565159</td>\n",
       "      <td>1</td>\n",
       "      <td>0.059856</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>5455 rows × 96 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "      Bankrupt?   ROA(C) before interest and depreciation before interest  \\\n",
       "0             0                                           0.498854          \n",
       "1             0                                           0.679764          \n",
       "2             0                                           0.543558          \n",
       "3             0                                           0.505192          \n",
       "4             0                                           0.539414          \n",
       "...         ...                                                ...          \n",
       "5450          0                                           0.555940          \n",
       "5451          0                                           0.456637          \n",
       "5452          1                                           0.448789          \n",
       "5453          0                                           0.550041          \n",
       "5454          0                                           0.526398          \n",
       "\n",
       "       ROA(A) before interest and % after tax  \\\n",
       "0                                    0.560565   \n",
       "1                                    0.719472   \n",
       "2                                    0.608973   \n",
       "3                                    0.570214   \n",
       "4                                    0.578500   \n",
       "...                                       ...   \n",
       "5450                                 0.618785   \n",
       "5451                                 0.519298   \n",
       "5452                                 0.508068   \n",
       "5453                                 0.595999   \n",
       "5454                                 0.586895   \n",
       "\n",
       "       ROA(B) before interest and depreciation after tax  \\\n",
       "0                                              0.549708    \n",
       "1                                              0.704053    \n",
       "2                                              0.597569    \n",
       "3                                              0.556025    \n",
       "4                                              0.597409    \n",
       "...                                                 ...    \n",
       "5450                                           0.603673    \n",
       "5451                                           0.509717    \n",
       "5452                                           0.499706    \n",
       "5453                                           0.593287    \n",
       "5454                                           0.566519    \n",
       "\n",
       "       Operating Gross Margin   Realized Sales Gross Margin  \\\n",
       "0                    0.607316                      0.607316   \n",
       "1                    0.616073                      0.615972   \n",
       "2                    0.611554                      0.611720   \n",
       "3                    0.604729                      0.604729   \n",
       "4                    0.615438                      0.615438   \n",
       "...                       ...                           ...   \n",
       "5450                 0.630306                      0.630306   \n",
       "5451                 0.595764                      0.595749   \n",
       "5452                 0.602099                      0.602099   \n",
       "5453                 0.618242                      0.619294   \n",
       "5454                 0.606740                      0.606740   \n",
       "\n",
       "       Operating Profit Rate   Pre-tax net Interest Rate  \\\n",
       "0                   0.999055                    0.797450   \n",
       "1                   0.999202                    0.797674   \n",
       "2                   0.999118                    0.797594   \n",
       "3                   0.999047                    0.797472   \n",
       "4                   0.999231                    0.797687   \n",
       "...                      ...                         ...   \n",
       "5450                0.999299                    0.797846   \n",
       "5451                0.998958                    0.797324   \n",
       "5452                0.998942                    0.797297   \n",
       "5453                0.999210                    0.797626   \n",
       "5454                0.999103                    0.797606   \n",
       "\n",
       "       After-tax net Interest Rate  \\\n",
       "0                         0.809359   \n",
       "1                         0.809526   \n",
       "2                         0.809503   \n",
       "3                         0.809390   \n",
       "4                         0.809584   \n",
       "...                            ...   \n",
       "5450                      0.809682   \n",
       "5451                      0.809262   \n",
       "5452                      0.809229   \n",
       "5453                      0.809502   \n",
       "5454                      0.809470   \n",
       "\n",
       "       Non-industry income and expenditure/revenue  ...  \\\n",
       "0                                         0.303450  ...   \n",
       "1                                         0.303534  ...   \n",
       "2                                         0.303569  ...   \n",
       "3                                         0.303504  ...   \n",
       "4                                         0.303496  ...   \n",
       "...                                            ...  ...   \n",
       "5450                                      0.303632  ...   \n",
       "5451                                      0.303433  ...   \n",
       "5452                                      0.303420  ...   \n",
       "5453                                      0.303434  ...   \n",
       "5454                                      0.303622  ...   \n",
       "\n",
       "       Net Income to Total Assets   Total assets to GNP price  \\\n",
       "0                        0.807623                    0.001475   \n",
       "1                        0.899004                    0.000855   \n",
       "2                        0.841140                    0.004898   \n",
       "3                        0.817066                    0.002805   \n",
       "4                        0.821655                    0.009206   \n",
       "...                           ...                         ...   \n",
       "5450                     0.832318                    0.000265   \n",
       "5451                     0.788500                    0.005053   \n",
       "5452                     0.778877                    0.000772   \n",
       "5453                     0.828522                    0.000983   \n",
       "5454                     0.828627                    0.002505   \n",
       "\n",
       "       No-credit Interval   Gross Profit to Sales  \\\n",
       "0                0.623535                0.607317   \n",
       "1                0.623871                0.616068   \n",
       "2                0.624184                0.611554   \n",
       "3                0.624377                0.604729   \n",
       "4                0.623211                0.615437   \n",
       "...                   ...                     ...   \n",
       "5450             0.624879                0.630304   \n",
       "5451             0.623824                0.595764   \n",
       "5452             0.623349                0.602094   \n",
       "5453             0.623696                0.618238   \n",
       "5454             0.624714                0.606739   \n",
       "\n",
       "       Net Income to Stockholder's Equity   Liability to Equity  \\\n",
       "0                                0.841014              0.280081   \n",
       "1                                0.846265              0.276771   \n",
       "2                                0.842434              0.275700   \n",
       "3                                0.841313              0.276750   \n",
       "4                                0.841686              0.277291   \n",
       "...                                   ...                   ...   \n",
       "5450                             0.842058              0.276061   \n",
       "5451                             0.839630              0.276012   \n",
       "5452                             0.836233              0.300209   \n",
       "5453                             0.843258              0.282299   \n",
       "5454                             0.841982              0.276632   \n",
       "\n",
       "       Degree of Financial Leverage (DFL)  \\\n",
       "0                                0.027375   \n",
       "1                                0.026791   \n",
       "2                                0.026791   \n",
       "3                                0.026837   \n",
       "4                                0.026900   \n",
       "...                                   ...   \n",
       "5450                             0.026863   \n",
       "5451                             0.026779   \n",
       "5452                             0.026522   \n",
       "5453                             0.026844   \n",
       "5454                             0.026791   \n",
       "\n",
       "       Interest Coverage Ratio (Interest expense to EBIT)   Net Income Flag  \\\n",
       "0                                              0.566952                   1   \n",
       "1                                              0.565158                   1   \n",
       "2                                              0.565159                   1   \n",
       "3                                              0.565368                   1   \n",
       "4                                              0.565631                   1   \n",
       "...                                                 ...                 ...   \n",
       "5450                                           0.565480                   1   \n",
       "5451                                           0.565101                   1   \n",
       "5452                                           0.563438                   1   \n",
       "5453                                           0.565399                   1   \n",
       "5454                                           0.565159                   1   \n",
       "\n",
       "       Equity to Liability  \n",
       "0                 0.028160  \n",
       "1                 0.056558  \n",
       "2                 0.105285  \n",
       "3                 0.057029  \n",
       "4                 0.047331  \n",
       "...                    ...  \n",
       "5450              0.080379  \n",
       "5451              0.082966  \n",
       "5452              0.014024  \n",
       "5453              0.022939  \n",
       "5454              0.059856  \n",
       "\n",
       "[5455 rows x 96 columns]"
      ]
     },
     "execution_count": 13,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "train_clean = pd.concat([y_train, X_train], axis = 1).reset_index(drop=True)\n",
    "train_clean"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "id": "47365d2b",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Bankrupt?</th>\n",
       "      <th>ROA(C) before interest and depreciation before interest</th>\n",
       "      <th>ROA(A) before interest and % after tax</th>\n",
       "      <th>ROA(B) before interest and depreciation after tax</th>\n",
       "      <th>Operating Gross Margin</th>\n",
       "      <th>Realized Sales Gross Margin</th>\n",
       "      <th>Operating Profit Rate</th>\n",
       "      <th>Pre-tax net Interest Rate</th>\n",
       "      <th>After-tax net Interest Rate</th>\n",
       "      <th>Non-industry income and expenditure/revenue</th>\n",
       "      <th>...</th>\n",
       "      <th>Net Income to Total Assets</th>\n",
       "      <th>Total assets to GNP price</th>\n",
       "      <th>No-credit Interval</th>\n",
       "      <th>Gross Profit to Sales</th>\n",
       "      <th>Net Income to Stockholder's Equity</th>\n",
       "      <th>Liability to Equity</th>\n",
       "      <th>Degree of Financial Leverage (DFL)</th>\n",
       "      <th>Interest Coverage Ratio (Interest expense to EBIT)</th>\n",
       "      <th>Net Income Flag</th>\n",
       "      <th>Equity to Liability</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>0</td>\n",
       "      <td>0.498854</td>\n",
       "      <td>0.560565</td>\n",
       "      <td>0.549708</td>\n",
       "      <td>0.607316</td>\n",
       "      <td>0.607316</td>\n",
       "      <td>0.999055</td>\n",
       "      <td>0.797450</td>\n",
       "      <td>0.809359</td>\n",
       "      <td>0.303450</td>\n",
       "      <td>...</td>\n",
       "      <td>0.807623</td>\n",
       "      <td>0.001475</td>\n",
       "      <td>0.623535</td>\n",
       "      <td>0.607317</td>\n",
       "      <td>0.841014</td>\n",
       "      <td>0.280081</td>\n",
       "      <td>0.027375</td>\n",
       "      <td>0.566952</td>\n",
       "      <td>1</td>\n",
       "      <td>0.028160</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>0</td>\n",
       "      <td>0.679764</td>\n",
       "      <td>0.719472</td>\n",
       "      <td>0.704053</td>\n",
       "      <td>0.616073</td>\n",
       "      <td>0.615972</td>\n",
       "      <td>0.999202</td>\n",
       "      <td>0.797674</td>\n",
       "      <td>0.809526</td>\n",
       "      <td>0.303534</td>\n",
       "      <td>...</td>\n",
       "      <td>0.899004</td>\n",
       "      <td>0.000855</td>\n",
       "      <td>0.623871</td>\n",
       "      <td>0.616068</td>\n",
       "      <td>0.846265</td>\n",
       "      <td>0.276771</td>\n",
       "      <td>0.026791</td>\n",
       "      <td>0.565158</td>\n",
       "      <td>1</td>\n",
       "      <td>0.056558</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>0</td>\n",
       "      <td>0.543558</td>\n",
       "      <td>0.608973</td>\n",
       "      <td>0.597569</td>\n",
       "      <td>0.611554</td>\n",
       "      <td>0.611720</td>\n",
       "      <td>0.999118</td>\n",
       "      <td>0.797594</td>\n",
       "      <td>0.809503</td>\n",
       "      <td>0.303569</td>\n",
       "      <td>...</td>\n",
       "      <td>0.841140</td>\n",
       "      <td>0.004898</td>\n",
       "      <td>0.624184</td>\n",
       "      <td>0.611554</td>\n",
       "      <td>0.842434</td>\n",
       "      <td>0.275700</td>\n",
       "      <td>0.026791</td>\n",
       "      <td>0.565159</td>\n",
       "      <td>1</td>\n",
       "      <td>0.105285</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>0</td>\n",
       "      <td>0.505192</td>\n",
       "      <td>0.570214</td>\n",
       "      <td>0.556025</td>\n",
       "      <td>0.604729</td>\n",
       "      <td>0.604729</td>\n",
       "      <td>0.999047</td>\n",
       "      <td>0.797472</td>\n",
       "      <td>0.809390</td>\n",
       "      <td>0.303504</td>\n",
       "      <td>...</td>\n",
       "      <td>0.817066</td>\n",
       "      <td>0.002805</td>\n",
       "      <td>0.624377</td>\n",
       "      <td>0.604729</td>\n",
       "      <td>0.841313</td>\n",
       "      <td>0.276750</td>\n",
       "      <td>0.026837</td>\n",
       "      <td>0.565368</td>\n",
       "      <td>1</td>\n",
       "      <td>0.057029</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>0</td>\n",
       "      <td>0.539414</td>\n",
       "      <td>0.578500</td>\n",
       "      <td>0.597409</td>\n",
       "      <td>0.615438</td>\n",
       "      <td>0.615438</td>\n",
       "      <td>0.999231</td>\n",
       "      <td>0.797687</td>\n",
       "      <td>0.809584</td>\n",
       "      <td>0.303496</td>\n",
       "      <td>...</td>\n",
       "      <td>0.821655</td>\n",
       "      <td>0.009206</td>\n",
       "      <td>0.623211</td>\n",
       "      <td>0.615437</td>\n",
       "      <td>0.841686</td>\n",
       "      <td>0.277291</td>\n",
       "      <td>0.026900</td>\n",
       "      <td>0.565631</td>\n",
       "      <td>1</td>\n",
       "      <td>0.047331</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5450</th>\n",
       "      <td>0</td>\n",
       "      <td>0.555940</td>\n",
       "      <td>0.618785</td>\n",
       "      <td>0.603673</td>\n",
       "      <td>0.630306</td>\n",
       "      <td>0.630306</td>\n",
       "      <td>0.999299</td>\n",
       "      <td>0.797846</td>\n",
       "      <td>0.809682</td>\n",
       "      <td>0.303632</td>\n",
       "      <td>...</td>\n",
       "      <td>0.832318</td>\n",
       "      <td>0.000265</td>\n",
       "      <td>0.624879</td>\n",
       "      <td>0.630304</td>\n",
       "      <td>0.842058</td>\n",
       "      <td>0.276061</td>\n",
       "      <td>0.026863</td>\n",
       "      <td>0.565480</td>\n",
       "      <td>1</td>\n",
       "      <td>0.080379</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5451</th>\n",
       "      <td>0</td>\n",
       "      <td>0.456637</td>\n",
       "      <td>0.519298</td>\n",
       "      <td>0.509717</td>\n",
       "      <td>0.595764</td>\n",
       "      <td>0.595749</td>\n",
       "      <td>0.998958</td>\n",
       "      <td>0.797324</td>\n",
       "      <td>0.809262</td>\n",
       "      <td>0.303433</td>\n",
       "      <td>...</td>\n",
       "      <td>0.788500</td>\n",
       "      <td>0.005053</td>\n",
       "      <td>0.623824</td>\n",
       "      <td>0.595764</td>\n",
       "      <td>0.839630</td>\n",
       "      <td>0.276012</td>\n",
       "      <td>0.026779</td>\n",
       "      <td>0.565101</td>\n",
       "      <td>1</td>\n",
       "      <td>0.082966</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5452</th>\n",
       "      <td>1</td>\n",
       "      <td>0.448789</td>\n",
       "      <td>0.508068</td>\n",
       "      <td>0.499706</td>\n",
       "      <td>0.602099</td>\n",
       "      <td>0.602099</td>\n",
       "      <td>0.998942</td>\n",
       "      <td>0.797297</td>\n",
       "      <td>0.809229</td>\n",
       "      <td>0.303420</td>\n",
       "      <td>...</td>\n",
       "      <td>0.778877</td>\n",
       "      <td>0.000772</td>\n",
       "      <td>0.623349</td>\n",
       "      <td>0.602094</td>\n",
       "      <td>0.836233</td>\n",
       "      <td>0.300209</td>\n",
       "      <td>0.026522</td>\n",
       "      <td>0.563438</td>\n",
       "      <td>1</td>\n",
       "      <td>0.014024</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5453</th>\n",
       "      <td>0</td>\n",
       "      <td>0.550041</td>\n",
       "      <td>0.595999</td>\n",
       "      <td>0.593287</td>\n",
       "      <td>0.618242</td>\n",
       "      <td>0.619294</td>\n",
       "      <td>0.999210</td>\n",
       "      <td>0.797626</td>\n",
       "      <td>0.809502</td>\n",
       "      <td>0.303434</td>\n",
       "      <td>...</td>\n",
       "      <td>0.828522</td>\n",
       "      <td>0.000983</td>\n",
       "      <td>0.623696</td>\n",
       "      <td>0.618238</td>\n",
       "      <td>0.843258</td>\n",
       "      <td>0.282299</td>\n",
       "      <td>0.026844</td>\n",
       "      <td>0.565399</td>\n",
       "      <td>1</td>\n",
       "      <td>0.022939</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5454</th>\n",
       "      <td>0</td>\n",
       "      <td>0.526398</td>\n",
       "      <td>0.586895</td>\n",
       "      <td>0.566519</td>\n",
       "      <td>0.606740</td>\n",
       "      <td>0.606740</td>\n",
       "      <td>0.999103</td>\n",
       "      <td>0.797606</td>\n",
       "      <td>0.809470</td>\n",
       "      <td>0.303622</td>\n",
       "      <td>...</td>\n",
       "      <td>0.828627</td>\n",
       "      <td>0.002505</td>\n",
       "      <td>0.624714</td>\n",
       "      <td>0.606739</td>\n",
       "      <td>0.841982</td>\n",
       "      <td>0.276632</td>\n",
       "      <td>0.026791</td>\n",
       "      <td>0.565159</td>\n",
       "      <td>1</td>\n",
       "      <td>0.059856</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>5455 rows × 96 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "      Bankrupt?   ROA(C) before interest and depreciation before interest  \\\n",
       "0             0                                           0.498854          \n",
       "1             0                                           0.679764          \n",
       "2             0                                           0.543558          \n",
       "3             0                                           0.505192          \n",
       "4             0                                           0.539414          \n",
       "...         ...                                                ...          \n",
       "5450          0                                           0.555940          \n",
       "5451          0                                           0.456637          \n",
       "5452          1                                           0.448789          \n",
       "5453          0                                           0.550041          \n",
       "5454          0                                           0.526398          \n",
       "\n",
       "       ROA(A) before interest and % after tax  \\\n",
       "0                                    0.560565   \n",
       "1                                    0.719472   \n",
       "2                                    0.608973   \n",
       "3                                    0.570214   \n",
       "4                                    0.578500   \n",
       "...                                       ...   \n",
       "5450                                 0.618785   \n",
       "5451                                 0.519298   \n",
       "5452                                 0.508068   \n",
       "5453                                 0.595999   \n",
       "5454                                 0.586895   \n",
       "\n",
       "       ROA(B) before interest and depreciation after tax  \\\n",
       "0                                              0.549708    \n",
       "1                                              0.704053    \n",
       "2                                              0.597569    \n",
       "3                                              0.556025    \n",
       "4                                              0.597409    \n",
       "...                                                 ...    \n",
       "5450                                           0.603673    \n",
       "5451                                           0.509717    \n",
       "5452                                           0.499706    \n",
       "5453                                           0.593287    \n",
       "5454                                           0.566519    \n",
       "\n",
       "       Operating Gross Margin   Realized Sales Gross Margin  \\\n",
       "0                    0.607316                      0.607316   \n",
       "1                    0.616073                      0.615972   \n",
       "2                    0.611554                      0.611720   \n",
       "3                    0.604729                      0.604729   \n",
       "4                    0.615438                      0.615438   \n",
       "...                       ...                           ...   \n",
       "5450                 0.630306                      0.630306   \n",
       "5451                 0.595764                      0.595749   \n",
       "5452                 0.602099                      0.602099   \n",
       "5453                 0.618242                      0.619294   \n",
       "5454                 0.606740                      0.606740   \n",
       "\n",
       "       Operating Profit Rate   Pre-tax net Interest Rate  \\\n",
       "0                   0.999055                    0.797450   \n",
       "1                   0.999202                    0.797674   \n",
       "2                   0.999118                    0.797594   \n",
       "3                   0.999047                    0.797472   \n",
       "4                   0.999231                    0.797687   \n",
       "...                      ...                         ...   \n",
       "5450                0.999299                    0.797846   \n",
       "5451                0.998958                    0.797324   \n",
       "5452                0.998942                    0.797297   \n",
       "5453                0.999210                    0.797626   \n",
       "5454                0.999103                    0.797606   \n",
       "\n",
       "       After-tax net Interest Rate  \\\n",
       "0                         0.809359   \n",
       "1                         0.809526   \n",
       "2                         0.809503   \n",
       "3                         0.809390   \n",
       "4                         0.809584   \n",
       "...                            ...   \n",
       "5450                      0.809682   \n",
       "5451                      0.809262   \n",
       "5452                      0.809229   \n",
       "5453                      0.809502   \n",
       "5454                      0.809470   \n",
       "\n",
       "       Non-industry income and expenditure/revenue  ...  \\\n",
       "0                                         0.303450  ...   \n",
       "1                                         0.303534  ...   \n",
       "2                                         0.303569  ...   \n",
       "3                                         0.303504  ...   \n",
       "4                                         0.303496  ...   \n",
       "...                                            ...  ...   \n",
       "5450                                      0.303632  ...   \n",
       "5451                                      0.303433  ...   \n",
       "5452                                      0.303420  ...   \n",
       "5453                                      0.303434  ...   \n",
       "5454                                      0.303622  ...   \n",
       "\n",
       "       Net Income to Total Assets   Total assets to GNP price  \\\n",
       "0                        0.807623                    0.001475   \n",
       "1                        0.899004                    0.000855   \n",
       "2                        0.841140                    0.004898   \n",
       "3                        0.817066                    0.002805   \n",
       "4                        0.821655                    0.009206   \n",
       "...                           ...                         ...   \n",
       "5450                     0.832318                    0.000265   \n",
       "5451                     0.788500                    0.005053   \n",
       "5452                     0.778877                    0.000772   \n",
       "5453                     0.828522                    0.000983   \n",
       "5454                     0.828627                    0.002505   \n",
       "\n",
       "       No-credit Interval   Gross Profit to Sales  \\\n",
       "0                0.623535                0.607317   \n",
       "1                0.623871                0.616068   \n",
       "2                0.624184                0.611554   \n",
       "3                0.624377                0.604729   \n",
       "4                0.623211                0.615437   \n",
       "...                   ...                     ...   \n",
       "5450             0.624879                0.630304   \n",
       "5451             0.623824                0.595764   \n",
       "5452             0.623349                0.602094   \n",
       "5453             0.623696                0.618238   \n",
       "5454             0.624714                0.606739   \n",
       "\n",
       "       Net Income to Stockholder's Equity   Liability to Equity  \\\n",
       "0                                0.841014              0.280081   \n",
       "1                                0.846265              0.276771   \n",
       "2                                0.842434              0.275700   \n",
       "3                                0.841313              0.276750   \n",
       "4                                0.841686              0.277291   \n",
       "...                                   ...                   ...   \n",
       "5450                             0.842058              0.276061   \n",
       "5451                             0.839630              0.276012   \n",
       "5452                             0.836233              0.300209   \n",
       "5453                             0.843258              0.282299   \n",
       "5454                             0.841982              0.276632   \n",
       "\n",
       "       Degree of Financial Leverage (DFL)  \\\n",
       "0                                0.027375   \n",
       "1                                0.026791   \n",
       "2                                0.026791   \n",
       "3                                0.026837   \n",
       "4                                0.026900   \n",
       "...                                   ...   \n",
       "5450                             0.026863   \n",
       "5451                             0.026779   \n",
       "5452                             0.026522   \n",
       "5453                             0.026844   \n",
       "5454                             0.026791   \n",
       "\n",
       "       Interest Coverage Ratio (Interest expense to EBIT)   Net Income Flag  \\\n",
       "0                                              0.566952                   1   \n",
       "1                                              0.565158                   1   \n",
       "2                                              0.565159                   1   \n",
       "3                                              0.565368                   1   \n",
       "4                                              0.565631                   1   \n",
       "...                                                 ...                 ...   \n",
       "5450                                           0.565480                   1   \n",
       "5451                                           0.565101                   1   \n",
       "5452                                           0.563438                   1   \n",
       "5453                                           0.565399                   1   \n",
       "5454                                           0.565159                   1   \n",
       "\n",
       "       Equity to Liability  \n",
       "0                 0.028160  \n",
       "1                 0.056558  \n",
       "2                 0.105285  \n",
       "3                 0.057029  \n",
       "4                 0.047331  \n",
       "...                    ...  \n",
       "5450              0.080379  \n",
       "5451              0.082966  \n",
       "5452              0.014024  \n",
       "5453              0.022939  \n",
       "5454              0.059856  \n",
       "\n",
       "[5455 rows x 96 columns]"
      ]
     },
     "execution_count": 15,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "train_dirty"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "id": "321396f4-5937-452c-94b4-2d22a0962439",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-10-12T01:36:13.476314Z",
     "iopub.status.busy": "2022-10-12T01:36:13.476082Z",
     "iopub.status.idle": "2022-10-12T01:36:15.834240Z",
     "shell.execute_reply": "2022-10-12T01:36:15.833952Z",
     "shell.execute_reply.started": "2022-10-12T01:36:13.476292Z"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "sample = train_clean.sample(1000)\n",
    "train_dirty = train_clean.copy()\n",
    "for k, v in sample.iterrows():\n",
    "    for i in range(random.randrange(1, len(train_clean.columns))):\n",
    "        col = random.choice(train_clean.columns.drop(['Bankrupt?', ' Net Income Flag', ' Liability-Assets Flag']))\n",
    "        train_dirty.at[k, col] *= random.randint(0, 2) + random.uniform(0, 1)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 25,
   "id": "b8d4f414",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "False"
      ]
     },
     "execution_count": 25,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "train_dirty.equals(train_clean)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 26,
   "id": "9a51d7ca-7bc4-4425-bf51-95f9a0826910",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-10-12T01:38:52.421857Z",
     "iopub.status.busy": "2022-10-12T01:38:52.421573Z",
     "iopub.status.idle": "2022-10-12T01:38:52.840890Z",
     "shell.execute_reply": "2022-10-12T01:38:52.840626Z",
     "shell.execute_reply.started": "2022-10-12T01:38:52.421827Z"
    }
   },
   "outputs": [],
   "source": [
    "train_dirty.to_csv('train_dirty.csv', index = False)\n",
    "test_clean.to_csv('test.csv', index = False)\n",
    "train_clean.to_csv('train_clean.csv', index = False)"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.9.12"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
